@page "/virus"
<h1>VirusTotal</h1>

<p>
	VirusTotal API lets you upload and scan files, IP addresses or
	URLs, access finished scan reports and make automatic
	comments without the need of using the website interface.
	In other words, it allows you to build simple
	scripts to access the information generated by VirusTotal.
</p>

<p>This text field is used to perform reconnaissance queries through the VirusTotal REST API</p>
<div class="form-group">
	<textarea class="form-control col-md-6" placeholder="Type IP address e.x. 212.77.100.101" @bind-value="IpAddress" @bind-value:event="oninput"></textarea>
	<small class="form-text text-muted">After typing address IP use Search button to proceed.</small>
</div>

<button class="btn btn-success" type="button" @onclick="BeginSearch">
	<span class="oi oi-magnifying-glass"></span> Search
</button>

@if (virus == null)
{

}
else
{
	<table class="table">
		<thead>
			<tr>
				<th>Response</th>
				<th>AS Number</th>
				<th>AS Owner</th>
				<th>Country</th>
				<th>Verbose Message</th>

			</tr>
		</thead>
		<tbody>

			<tr>
				<td>@virus.ResponseCode</td>
				<td>@virus.Asn</td>
				<td>@virus.AsOwner</td>
				<td>@virus.Country</td>
				<td>@virus.VerboseMsg</td>
			</tr>
		</tbody>
	</table>
}

<button class="btn btn-primary" type="button" @onclick="SaveToTxt">
	<span class="oi oi-arrow-thick-bottom"></span> Save Result
</button>

@code {


}
